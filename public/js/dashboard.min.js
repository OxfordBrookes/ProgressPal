var BASE_URL="",USER_ID=-1;(function(e,s,a){"use strict"
var r,l=function(){var s=parseInt(r.user/r.total*100),a=r.avg/r.total*100-s
a=parseInt(a>0?a:0,10),e(".bar.bar-danger").width(100-s-a+"%"),e(".bar.bar-warning").width(a+"%"),e(".bar.bar-success").width(s+"%")}
s=s[s.length-1]==="/"?s:s+"dashboard/",e.getJSON(s+"getProgress/"+a,function(e){r=e,l()}),e.getJSON(s+"getData/"+a,function(s){var n=function(e){var s,a,r,l,i=e.length,t=""
for(s=0;i>s;s+=1)a=e[s],r=a.children?"grey":a.complete===!0?"green":"red",l=a.children?"<div class='milestones' style='display:none'>\n"+n(a.children)+"</div>":"",t+="<div id='"+a.type+"_"+a.id+"' class='milestone'><div class='circle "+r+" pull-left'></div><div class='pull-left'><div class='name'>"+a.name+"</div><div class='desc'>"+a.desc+"</div></div><div class='clearfix'></div>"+l+"</div>"
return t}
e("#milestones").append(n(s))
var i=function(s,n,i){e.post("",{func:"changeComplete",userId:a,type:s,id:n,completed:i}),r.user+=i,l()},t=function(){var s=e(this),a=s.hasClass("circle")?s.parent():s.parent().parent(),r=a.attr("id").replace("module_","").replace("assignment_","").replace("milestone_",""),l=a.attr("id").split("_")[0],n=s.hasClass("circle")?s:e(s.parent().parent().children(".circle")[0])
n.hasClass("green")?(n.removeClass("green"),n.addClass("red"),i(l,r,-1)):n.hasClass("red")?(n.removeClass("red"),n.addClass("green"),i(l,r,1)):e(a.children(".milestones")).toggle("fast")}
e(".circle").on("click",t),e(".name").on("click",t),e(".desc").on("click",t)})})(jQuery,BASE_URL,USER_ID)
