var BASE_URL="",USER_ID=-1;(function(e,s,a,i){"use strict"
var r,n=function(e){var a=parseInt(r.user/r.total*100,10),i=r.avg/r.total*100-a
i=parseInt(i>0?i:0,10),1===e?(s(".bar.bar-danger").width(100-a-i+"%"),s(".bar.bar-warning").width(i+"%"),s(".bar.bar-success").width(a+"%")):(s(".bar.bar-success").width(a+"%"),s(".bar.bar-warning").width(i+"%"),s(".bar.bar-danger").width(100-a-i+"%"))}
a=a[a.length-1]==="/"?a:a+"dashboard/",s.getJSON(a+"getProgress/"+i,function(e){r=e,n()}),s.getJSON(a+"getData/"+i,function(e){var a=function(e){var s,i,r,n,l=e.length,t=""
for(s=0;l>s;s+=1)i=e[s],r=i.children?"grey":i.complete===!0?"green":"red",n=i.children?"<div class='milestones' style='display:none'>\n"+a(i.children)+"</div>":"",t+="<div id='"+i.type+"_"+i.id+"' class='milestone'><div class='circle "+r+" pull-left'></div><div class='pull-left'><div class='name'>"+i.name+"</div><div class='desc'>"+i.desc+"</div></div><div class='clearfix'></div>"+n+"</div>"
return t},l=function(e,a,l){s.post("",{func:"changeComplete",userId:i,type:e,id:a,completed:l}),r.user+=l,n(l)},t=function(){var e=s(this),a=e.hasClass("circle")?e.parent():e.parent().parent(),i=a.attr("id").replace("module_","").replace("assignment_","").replace("milestone_",""),r=a.attr("id").split("_")[0],n=e.hasClass("circle")?e:s(e.parent().parent().children(".circle")[0])
n.hasClass("green")?(n.removeClass("green"),n.addClass("red"),l(r,i,-1)):n.hasClass("red")?(n.removeClass("red"),n.addClass("green"),l(r,i,1)):s(a.children(".milestones")).toggle("fast")}
s("#milestones").append(a(e)),s(".circle").on("click",t),s(".name").on("click",t),s(".desc").on("click",t)}),s(e).jkey("ctrl+space",function(){var e=s(".milestones"),a=s(e[0]).children().children(".milestones").is(":visible")?"hide":"show",i=s(e.slice(1))
i[a]("hide"===a?"slow":null)})})(this.document,this.jQuery,BASE_URL,USER_ID)
