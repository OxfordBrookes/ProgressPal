var BASE_URL="",USER_ID=-1;(function(e,s,a,r){"use strict"
var i,n=function(e){var a=parseInt(i.user/i.total*100,10),r=i.avg/i.total*100-a
r=parseInt(r>0?r:0,10),1===e?(s(".bar.bar-danger").width(100-a-r+"%"),s(".bar.bar-warning").width(r+"%"),s(".bar.bar-success").width(a+"%")):(s(".bar.bar-success").width(a+"%"),s(".bar.bar-warning").width(r+"%"),s(".bar.bar-danger").width(100-a-r+"%"))}
a=a[a.length-1]==="/"?a:a+"dashboard/",s.getJSON(a+"getProgress/"+r,function(e){i=e,n()}),s.getJSON(a+"getData/"+r,function(e){var a=function(e){var s,r,i,n,l=e.length,t=""
for(s=0;l>s;s+=1)r=e[s],i=r.children?"grey":r.complete===!0?"green":"red",n=r.children?"<div class='milestones' style='display:none'>\n"+a(r.children)+"</div>":"",t+="<div id='"+r.type+"_"+r.id+"' class='milestone'><div class='circle "+i+" pull-left'></div><div class='pull-left'><div class='name'>"+r.name+"</div><div class='desc'>"+r.desc+"</div></div><div class='clearfix'></div>"+n+"</div>"
return t},l=function(e,a,l){s.post("",{func:"changeComplete",userId:r,type:e,id:a,completed:l}),i.user+=l,n(l)},t=function(){var e=s(this),a=e.hasClass("circle")?e.parent():e.parent().parent(),r=a.attr("id").replace("module_","").replace("assignment_","").replace("milestone_",""),i=a.attr("id").split("_")[0],n=e.hasClass("circle")?e:s(e.parent().parent().children(".circle")[0])
n.hasClass("green")?(n.removeClass("green"),n.addClass("red"),l(i,r,-1)):n.hasClass("red")?(n.removeClass("red"),n.addClass("green"),l(i,r,1)):s(a.children(".milestones")).toggle("fast")}
s("#milestones").append(a(e)),s(".circle").on("click",t),s(".name").on("click",t),s(".desc").on("click",t)}),s(e).jkey("ctrl+space",function(){var e=s(".milestones"),a=s(e[0]).children().children(".milestones").is(":visible")?"hide":"show",r=s(e.slice(1))
r[a]("hide"===a?"slow":null)})})(this.document,jQuery,BASE_URL,USER_ID)
