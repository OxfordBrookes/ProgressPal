var BASE_URL="",USER_ID=-1;(function(e,s,i,a){"use strict"
var r,n=function(e){var i=parseInt(r.user/r.total*100,10),a=r.avg/r.total*100-i
a=parseInt(a>0?a:0,10),1===e?(s(".bar.bar-danger").width(100-i-a+"%"),s(".bar.bar-warning").width(a+"%"),s(".bar.bar-success").width(i+"%")):(s(".bar.bar-success").width(i+"%"),s(".bar.bar-warning").width(a+"%"),s(".bar.bar-danger").width(100-i-a+"%"))}
i=i[i.length-1]==="/"?i:i+"dashboard/",s.getJSON(i+"getProgress/"+a,function(e){r=e,n()}),s.getJSON(i+"getData/"+a,function(e){var i=function(e){var s,a,r,n,l=e.length,t=""
for(s=0;l>s;s+=1)a=e[s],r=a.children?"grey":a.complete===!0?"green":"red",n=a.children?"<div class='milestones' style='display:none'>\n"+i(a.children)+"</div>":"",t+="<div id='"+a.type+"_"+a.id+"' class='milestone'><div class='circle "+r+" pull-left'></div><div class='pull-left'><div class='name'>"+a.name+"</div><div class='desc'>"+a.desc+"</div></div><div class='clearfix'></div>"+n+"</div>"
return t},l=function(e,i,l){s.post("",{func:"changeComplete",userId:a,type:e,id:i,completed:l}),r.user+=l,n(l)},t=function(){var e=s(this),i=e.hasClass("circle")?e.parent():e.parent().parent(),a=i.attr("id").replace("module_","").replace("assignment_","").replace("milestone_",""),r=i.attr("id").split("_")[0],n=e.hasClass("circle")?e:s(e.parent().parent().children(".circle")[0])
n.hasClass("green")?(n.removeClass("green"),n.addClass("red"),l(r,a,-1)):n.hasClass("red")?(n.removeClass("red"),n.addClass("green"),l(r,a,1)):s(i.children(".milestones")).toggle("fast")}
s("#milestones").append(i(e)),s(".circle").on("click",t),s(".name").on("click",t),s(".desc").on("click",t)}),s(e).jkey("ctrl+space",function(){var e=s(".milestones"),i=s(e[0]).children().children(".milestones").is(":visible")?"hide":"show",a=s(e.slice(1))
"show"===i&&s(e[0]).children().children().find(".milestones").show(),a[i]("slow")})})(this.document,this.jQuery,BASE_URL,USER_ID)
